import{a as re}from"./chunk-BKTNEFLF.js";import{a as Je}from"./chunk-BAC247KU.js";import{a as $e,b as Ge,c as Qe,d as ie,e as Xe,f as Ye,g as oe}from"./chunk-EIU5E3HU.js";import"./chunk-DTBVBDW5.js";import{a as Ze}from"./chunk-CCGLYVEU.js";import"./chunk-LSD4F7KH.js";import{a as ee,b as ze,c as qe,f as te}from"./chunk-BQIAFBQH.js";import{A as Y,D as Z,E as J,b as B,f as U,i as z,q,s as Le,t as $,u as X}from"./chunk-F4KKBD6I.js";import{B as De,C as Ve,a as H,b as ke,c as W,d as Ee,e as Re,ea as G,g as Ne,ga as je,h as I,ha as Q,i as Oe,ia as Ue,ja as K,ka as Ke}from"./chunk-6QGYQCVO.js";import{c as He,d as le,e as We,g as F,j as Be,l as O}from"./chunk-CARY4E7O.js";import{Ab as T,Db as h,Ec as b,Fb as P,Ga as ue,Jb as Pe,Kb as we,Lb as be,Mb as L,Nb as c,Ob as k,Pb as j,Sb as E,Tb as R,Ua as d,Ub as N,Va as u,Wa as he,Wb as w,Y as de,Ya as fe,_ as D,_a as ge,ab as ve,bb as Ce,ea as _,eb as _e,ja as S,kb as A,ma as pe,mb as M,ra as g,rb as Me,rc as Ie,sa as v,sc as Fe,tb as ye,tc as xe,ub as Se,vb as s,wb as m,xb as V,xc as Ae,yc as Te}from"./chunk-SYRJLQDL.js";var x=(()=>{class i{constructor(){this.loggedIn=_e(!1)}login(){this.loggedIn.set(!0)}logout(){this.loggedIn.set(!1)}isAuthenticated(){return this.loggedIn()}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var f=(i,r)=>{let e=_(x),t=_(I);return e.isAuthenticated()?!0:t.createUrlTree(["/login"])};function Ct(i,r){if(i&1&&(s(0,"div",6),c(1),m()),i&2){let e=P();d(),k(e.errorMessage)}}var tt=(()=>{class i{constructor(e,t,o,n){this.http=e,this.router=t,this.authService=o,this.productService=n,this.username="",this.password="",this.errorMessage="",this.configUrl="assets/config/config.json",this.storedUser="",this.storedPassword=""}ngOnInit(){this.http.get(this.configUrl).subscribe({next:e=>{this.storedUser=e.username,this.storedPassword=e.password},error:e=>{console.error("Error loading config.json",e),this.errorMessage="Internal error, contact support"}})}login(){this.username===this.storedUser&&this.password===this.storedPassword?(this.productService.loadProducts(),this.authService.login(),this.router.navigate(["/home"])):this.errorMessage="Incorrect username or password"}static{this.\u0275fac=function(t){return new(t||i)(u(H),u(I),u(x),u(re))}}static{this.\u0275cmp=S({type:i,selectors:[["app-login"]],standalone:!0,features:[w],decls:14,vars:3,consts:[[1,"login-card"],["appearance","outline"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","type","password",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary",3,"click"],["class","error",4,"ngIf"],[1,"error"]],template:function(t,o){t&1&&(s(0,"mat-card",0)(1,"h2"),c(2,"Login"),m(),s(3,"mat-form-field",1)(4,"mat-label"),c(5,"Username"),m(),s(6,"input",2),N("ngModelChange",function(l){return R(o.username,l)||(o.username=l),l}),m()(),s(7,"mat-form-field",1)(8,"mat-label"),c(9,"Password"),m(),s(10,"input",3),N("ngModelChange",function(l){return R(o.password,l)||(o.password=l),l}),m()(),s(11,"button",4),h("click",function(){return o.login()}),c(12,"Login"),m(),A(13,Ct,2,1,"div",5),m()),t&2&&(d(6),E("ngModel",o.username),d(4),E("ngModel",o.password),d(3),M("ngIf",o.errorMessage))},dependencies:[b,Te,W,q,B,U,z,$,Q,G,J,Z,Y,X,K,te,ee,ie,oe],styles:[".login-card[_ngcontent-%COMP%]{width:90%;max-width:400px;margin:100px auto;padding:2rem;display:flex;flex-direction:column;gap:1.2rem}.login-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center}.login-card[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;text-align:center}"]})}}return i})();var _t=["drawer"],Mt=(i,r)=>r.name;function yt(i,r){if(i&1){let e=T();s(0,"mat-list-item",15),h("click",function(){let o=g(e).$implicit,n=P();return v(n.seleccionarPest(o))}),c(1),m()}if(i&2){let e=r.$implicit;d(),j(" ",e," ")}}function St(i,r){if(i&1){let e=T();s(0,"button",16),h("click",function(){g(e),P();let o=L(2);return v(o.toggle())}),s(1,"mat-icon"),c(2,"menu"),m()()}}function Pt(i,r){if(i&1){let e=T();s(0,"mat-card",17),h("click",function(){let o=g(e).$implicit,n=P();return v(n.goToDetail(o.id))}),s(1,"mat-card-title"),c(2),m(),s(3,"mat-card-content")(4,"p")(5,"strong"),c(6,"Active Ingredient:"),m(),c(7),m()()()}if(i&2){let e=r.$implicit;d(2),k(e.name),d(5),j(" ",e.activeIngredients,"")}}var it=(()=>{class i{constructor(e,t,o,n,l,a,p){this.http=e,this.router=t,this.authService=o,this.breakpointObserver=n,this.productService=l,this.favService=a,this.navegateService=p,this.allProducts=[],this.filteredProducts=[],this.uniquePests=[],this.searchTerm="",this.version="v1.0.0",this.configUrl="assets/config/products.json",this.errorMessage="",this.isWideScreen=!0,this.pestName="",this.isFavoriteView=!1,this.favorites=[],this.productStoreService=_(Ze)}ngOnInit(){this.breakpointObserver.observe([Ve.Handset]).subscribe(t=>{this.isWideScreen=!t.matches});let e=this.productService.products();this.allProducts=e,this.filteredProducts=e,e!=null&&e!=null&&e.length>0&&this.getUniquePests(this.allProducts),this.checkFavorites(),this.productStoreService.loadAll()}checkFavorites(){this.favorites=this.favService.getFavorites(),this.favorites!=null&&this.favorites!=null&&this.favorites.length>0&&(this.isFavoriteView=!0)}getUniquePests(e){let t=new Set;for(let o of e)o.pestsControlled.forEach(n=>t.add(n));this.uniquePests=Array.from(t)}logout(){this.authService.logout(),this.router.navigate(["/login"])}getPestName(e){let t=n=>n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),o=t(e);for(let n of this.filteredProducts)for(let l of n.pestsControlled)if(t(l).includes(o))return l;return""}getPestToGo(e,t){let o=this.filteredProducts.find(a=>a.id===t);if(!o)return"";let n=a=>a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),l=n(e);for(let a of o.pestsControlled)if(n(a).includes(l))return a;return""}buscarCoincidencias(){let e=this.searchTerm.trim().toLowerCase(),t=a=>a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),o=a=>{let p=t(a.name),C=t(a.applicationTreatment),y=t(a.pestsControlled.join(" "));return`${p} ${C} ${y}`},n=a=>`${t(a.name)}`,l=a=>{let p=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`\\b${p}\\b`,"i")};if(e.includes("&")){let a=t(e.split("&")[1]?.trim()||"");a.length>=2?this.filteredProducts=this.allProducts.filter(p=>n(p).includes(a)):this.filteredProducts=[]}else if(e.includes("-")){let a="",p="",[C,y]=e.split("-").map(se=>t(se.trim()));a=C,p=y;let ae=l(C),lt=l(y);this.filteredProducts=this.allProducts.filter(se=>{let ce=o(se);return ae.test(ce)&&lt.test(ce)}),this.pestName=this.getPestName(p),this.pestName===""&&(this.pestName=this.getPestName(a))}else{let p=t(e).split(/\s+/).join(" ").trim(),C=l(p);this.filteredProducts=this.allProducts.filter(y=>{let ae=o(y);return C.test(ae)}),this.pestName=this.getPestName(e)}}seleccionarPest(e){this.isWideScreen=!1,this.isWideScreen||this.drawer.close(),this.searchTerm=e,this.buscarCoincidencias(),this.pestName=e}goToDetail(e){let t=this.getPestToGo(this.pestName,e);this.navegateService.goToDetail("product",e,t)}goFavorites(){this.navegateService.goFavorites("favorites",1)}static{this.\u0275fac=function(t){return new(t||i)(u(H),u(I),u(x),u(De),u(re),u(Je),u(Ke))}}static{this.\u0275cmp=S({type:i,selectors:[["app-home"]],viewQuery:function(t,o){if(t&1&&Pe(_t,5),t&2){let n;we(n=be())&&(o.drawer=n.first)}},standalone:!0,features:[w],decls:27,vars:6,consts:[["drawer",""],[1,"container"],["mode","side",1,"sidenav",3,"opened"],[3,"click",4,"ngFor","ngForOf"],["color","primary",1,"mobile-toolbar"],["mat-icon-button",""],[1,"spacer"],["mat-icon-button","","matTooltip","Favorites","aria-label","Favorites",3,"click"],["mat-button","",3,"click"],[1,"content"],["appearance","fill",1,"search-box"],["matInput","",3,"ngModelChange","input","ngModel"],[1,"results"],[1,"clickable-card"],[1,"footer"],[3,"click"],["mat-icon-button","",3,"click"],[1,"clickable-card",3,"click"]],template:function(t,o){if(t&1){let n=T();s(0,"mat-sidenav-container",1)(1,"mat-sidenav",2,0)(3,"mat-nav-list"),A(4,yt,2,1,"mat-list-item",3),m()(),s(5,"mat-sidenav-content")(6,"mat-toolbar",4),A(7,St,3,0,"button",5),s(8,"span"),c(9,"Pest products"),m(),V(10,"span",6),s(11,"button",7),h("click",function(){return g(n),v(o.goFavorites())}),s(12,"mat-icon"),c(13),m()(),s(14,"button",8),h("click",function(){return g(n),v(o.logout())}),s(15,"mat-icon"),c(16,"exit_to_app"),m()()(),s(17,"div",9)(18,"mat-form-field",10)(19,"mat-label"),c(20,"Search for product or pest"),m(),s(21,"input",11),N("ngModelChange",function(a){return g(n),R(o.searchTerm,a)||(o.searchTerm=a),v(a)}),h("input",function(){return g(n),v(o.buscarCoincidencias())}),m()(),s(22,"div",12),ye(23,Pt,8,2,"mat-card",13,Mt),m()(),s(25,"footer",14),c(26),m()()()}t&2&&(d(),M("opened",o.isWideScreen),d(3),M("ngForOf",o.uniquePests),d(3),Me(7,o.isWideScreen?-1:7),d(6),k(o.isFavoriteView?"star":"star_border"),d(8),E("ngModel",o.searchTerm),d(2),Se(o.filteredProducts),d(3),j("Version: ",o.version,""))},dependencies:[b,Ae,W,q,B,U,z,$,Le,Q,G,je,J,Z,Y,X,K,Ue,te,ee,qe,ze,ie,Ge,Qe,$e,oe,Ye,Xe],styles:[".container[_ngcontent-%COMP%]{height:100vh}.sidenav[_ngcontent-%COMP%]{width:200px}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.content[_ngcontent-%COMP%]{padding:1rem}.content[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:1rem auto;display:block}.content[_ngcontent-%COMP%]   .results[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:1rem}.footer[_ngcontent-%COMP%]{text-align:center;padding:1rem;background-color:#eee;font-size:.9rem}.clickable-card[_ngcontent-%COMP%]{padding:1rem;cursor:pointer;transition:transform .2s}.clickable-card[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.mat-icon.star-active[_ngcontent-%COMP%]{color:gold}"]})}}return i})();var ot=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:tt},{path:"home",component:it,data:{animation:"HomePage"},canActivate:[f]},{path:"product/:id",loadComponent:()=>import("./chunk-VHOXS7IF.js").then(i=>i.ProductDetailComponent),canActivate:[f]},{path:"favorites/:id",loadComponent:()=>import("./chunk-NGNZELIQ.js").then(i=>i.FavoritesComponent),data:{animation:"FavoritesPage"},canActivate:[f]},{path:"formulations",loadComponent:()=>import("./chunk-6UDYZGTC.js").then(i=>i.FormulationsListComponent),data:{animation:"FormulationPage"},canActivate:[f]},{path:"formulation/add",loadComponent:()=>import("./chunk-RL6KRRNK.js").then(i=>i.FormulationAddComponent),data:{animation:"FormulationPage"},canActivate:[f]},{path:"formulation/:id",loadComponent:()=>import("./chunk-MJEOZ2O3.js").then(i=>i.FormulationDetailComponent),data:{animation:"FormulationPage"},canActivate:[f]},{path:"formulation/edit/:id",loadComponent:()=>import("./chunk-BBT6XDRT.js").then(i=>i.FormulationEditComponent),data:{animation:"FormulationPage"},canActivate:[f]},{path:"storage",canActivate:[f],children:[{path:"products",loadComponent:()=>import("./chunk-RHNKM4QK.js").then(i=>i.ProductListComponent),data:{animation:"StoragePage"}},{path:"products/add",loadComponent:()=>import("./chunk-73GLMQUD.js").then(i=>i.AddProductComponent),data:{animation:"StoragePage"}},{path:"products/detail/:id",loadComponent:()=>import("./chunk-IKQ7WQ3J.js").then(i=>i.StorageProductDetailComponent),data:{animation:"StoragePage"}},{path:"products/edit/:id",loadComponent:()=>import("./chunk-5IPNSMPY.js").then(i=>i.EditProductComponent),data:{animation:"StoragePage"}},{path:"products/register/use",loadComponent:()=>import("./chunk-ZPCLH6LE.js").then(i=>i.RegisterProductUsageComponent),data:{animation:"StoragePage"}}]},{path:"**",redirectTo:"/login"}];var wt="@",bt=(()=>{class i{constructor(e,t,o,n,l){this.doc=e,this.delegate=t,this.zone=o,this.animationType=n,this.moduleImpl=l,this._rendererFactoryPromise=null,this.scheduler=_(fe,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-IOR4IIAH.js")).catch(t=>{throw new de(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:o})=>{this._engine=t(this.animationType,this.doc,this.scheduler);let n=new o(this.delegate,this._engine,this.zone);return this.delegate=n,n})}createRenderer(e,t){let o=this.delegate.createRenderer(e,t);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let n=new me(o);return t?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(l=>{let a=l.createRenderer(e,t);n.use(a)}).catch(l=>{n.use(o)}),n}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(t){he()}}static{this.\u0275prov=D({token:i,factory:i.\u0275fac})}}return i})(),me=class{constructor(r){this.delegate=r,this.replay=[],this.\u0275type=1}use(r){if(this.delegate=r,this.replay!==null){for(let e of this.replay)e(r);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(r,e){return this.delegate.createElement(r,e)}createComment(r){return this.delegate.createComment(r)}createText(r){return this.delegate.createText(r)}get destroyNode(){return this.delegate.destroyNode}appendChild(r,e){this.delegate.appendChild(r,e)}insertBefore(r,e,t,o){this.delegate.insertBefore(r,e,t,o)}removeChild(r,e,t){this.delegate.removeChild(r,e,t)}selectRootElement(r,e){return this.delegate.selectRootElement(r,e)}parentNode(r){return this.delegate.parentNode(r)}nextSibling(r){return this.delegate.nextSibling(r)}setAttribute(r,e,t,o){this.delegate.setAttribute(r,e,t,o)}removeAttribute(r,e,t){this.delegate.removeAttribute(r,e,t)}addClass(r,e){this.delegate.addClass(r,e)}removeClass(r,e){this.delegate.removeClass(r,e)}setStyle(r,e,t,o){this.delegate.setStyle(r,e,t,o)}removeStyle(r,e,t){this.delegate.removeStyle(r,e,t)}setProperty(r,e,t){this.shouldReplay(e)&&this.replay.push(o=>o.setProperty(r,e,t)),this.delegate.setProperty(r,e,t)}setValue(r,e){this.delegate.setValue(r,e)}listen(r,e,t){return this.shouldReplay(e)&&this.replay.push(o=>o.listen(r,e,t)),this.delegate.listen(r,e,t)}shouldReplay(r){return this.replay!==null&&r.startsWith(wt)}};function rt(i="animations"){return ve("NgAsyncAnimations"),pe([{provide:ge,useFactory:(r,e,t)=>new bt(r,e,t,i),deps:[Ie,Ee,Ce]},{provide:ue,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var nt={providers:[Oe(ot),rt(),ke(),{provide:Fe,useClass:xe}]};var at=He("routeAnimations",[Be("* <=> *",[F({position:"relative"}),O(":enter, :leave",[F({position:"absolute",width:"100%",opacity:0})],{optional:!0}),O(":enter",[F({opacity:0})],{optional:!0}),We([O(":leave",[le("200ms ease-out",F({opacity:0}))],{optional:!0}),O(":enter",[le("200ms ease-in",F({opacity:1}))],{optional:!0})])])]);var st=(()=>{class i{constructor(){this.title="referent-product-pest"}getAnimationState(e){return e&&e.activatedRouteData&&e.activatedRouteData.animation}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=S({type:i,selectors:[["app-root"]],standalone:!0,features:[w],decls:3,vars:1,consts:[["outlet","outlet"]],template:function(t,o){if(t&1&&(s(0,"main"),V(1,"router-outlet",null,0),m()),t&2){let n=L(2);M("@routeAnimations",o.getAnimationState(n))}},dependencies:[b,Ne],data:{animation:[at]}})}}return i})();Re(st,nt).catch(i=>console.error(i));
