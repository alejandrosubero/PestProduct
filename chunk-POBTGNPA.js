import{a as ut,b as mt,c as ct,d as lt,e as dt}from"./chunk-QYIO6RX7.js";import{a as st}from"./chunk-DG2GUF4V.js";import{a as it}from"./chunk-IXAEBCIV.js";import"./chunk-6FCDGXAG.js";import"./chunk-JYKJOJ6J.js";import{b as nt}from"./chunk-H4MXZYYG.js";import"./chunk-4JNPEXEF.js";import"./chunk-FYP6HQPU.js";import{a as et}from"./chunk-S456R345.js";import{c as j,e as Y}from"./chunk-5ETXQJ6Z.js";import{c as $,f as z,i as K,j as H,l as J,m as X}from"./chunk-RPOOMM4R.js";import{a as at}from"./chunk-MAELP3WW.js";import"./chunk-7GZRYZ3W.js";import"./chunk-CARY4E7O.js";import"./chunk-HEOXUAG5.js";import{b as W}from"./chunk-NMLM2UYX.js";import{c as V}from"./chunk-JVFQFS5Z.js";import{fa as R,ma as Z,na as tt}from"./chunk-OUSHV2EZ.js";import{a as ot,b as rt}from"./chunk-NKIKHFFW.js";import{b as I,d as v,f as O,g as B,j as E,k as G,l as q,m as L,s as Q,u as U}from"./chunk-ZQAR5GQS.js";import{$a as _,Cb as r,Db as a,Eb as f,Ib as h,Lb as g,Mc as w,Nb as M,Nc as A,Rc as F,Tc as D,Ub as y,Vb as m,Xb as T,Y as C,_a as c,cc as N,hc as x,ic as k,ja as s,oa as S,rb as p,tb as u,v as b,wa as l,xa as d}from"./chunk-BTT23VXK.js";function pt(o,P){if(o&1){let t=h();r(0,"button",9),g("click",function(){l(t);let i=M();return d(i.clearInput())}),r(1,"mat-icon"),m(2,"close"),a()()}}function ft(o,P){if(o&1&&(r(0,"mat-option",10),m(1),a()),o&2){let t=P.$implicit;u("value",t),c(),T(" ",t," ")}}var jt=(()=>{class o{constructor(t){this.router=t,this.productTypes=mt,this.status=ut,this.units=[],this.fb=s(Q),this.store=s(it),this.navegateService=s(at),this.unitService=s(st),this.productService=s(et),this.navService=s(rt),this.pestData={id:0,name:""},this.id=0,this.nameToNavegate="",this.allProducts=[],this.options=[],this.nameValue="",this.setForm(),this.setNav()}ngOnInit(){this.setList(),this.controlFN(),this.form.get("name")?.valueChanges.subscribe(t=>{this.nameValue=t,this.nameValue&&(this.isTheProduct=this.getProductByName(this.nameValue))}),this.getData()}setForm(){this.form=this.fb.group({name:["",v.required],quantity:[0,v.required]})}setNav(){this.navService.reSetNavConfig();let t=new ot;t.title="Add Product",t.ico.menu=!1,t.ico.back=!0,t.ico.favorite=!1,t.ico.logut=!1,t.ico.label=!1,t.ico.sds=!1,t.goto="app/storage/products",this.navService.setNavConfig(t)}clearInput(){this.form.get("name")?.setValue("")}checkValue(){return this.nameValue!==""}products(){return this.store.filteredProducts().sort((i,n)=>i.name.localeCompare(n.name))}setList(){this.allProducts=this.products(),this.allProducts!=null&&this.allProducts!=null&&this.allProducts.length>0&&(this.options=this.getProductNames(this.allProducts))}getProductNames(t){return t.map(e=>e.name)}getProductByName(t){return this.allProducts.find(e=>e.name===t)}controlFN(){if(!this.form){console.error("AutocompleteInputComponent: error FormGroup.");return}let t=this.form.get("name");if(!t){console.error("AutocompleteInputComponent: error in 'name' no find FormGroup.");return}this.filteredOptions=t.valueChanges.pipe(C(""),b(e=>this._filter(e||"")))}_filter(t){let e=t.toLowerCase();return this.options.filter(i=>i.toLowerCase().includes(e))}save(){let t=this.form.value;if((this.isTheProduct===void 0||this.isTheProduct===null)&&(this.isTheProduct=this.getProductByName(t.name)),this.isTheProduct&&this.isTheProduct.package){if(this.isTheProduct.package.additions===void 0||this.isTheProduct.package.additions===null){this.isTheProduct.package.additions=[];let n={quantity:this.isTheProduct.package.initialQuantity,addDate:new Date};this.isTheProduct.package.additions.push(n)}let e=this.isTheProduct.package.currentQuantity+t.quantity;this.isTheProduct.package.initialQuantity=e,this.isTheProduct.package.currentQuantity=e;let i={quantity:t.quantity,addDate:new Date};this.isTheProduct.package.additions.push(i),this.store.update(this.isTheProduct),this.goBack()}}goBack(){this.router.navigate(["app/storage/products"])}getData(){this.pestData=this.navegateService.getData(this.router),this.pestData!=null&&this.pestData!=null&&(this.id=this.pestData.id,this.nameToNavegate=this.pestData.name,this.id!==void 0&&this.id!==null&&this.workWithData())}workWithData(){let t=this.store.findById(this.id);t!=null&&(this.form.patchValue({name:t.name}),this.isTheProduct=t)}static{this.\u0275fac=function(e){return new(e||o)(_(V))}}static{this.\u0275cmp=S({type:o,selectors:[["app-addition-produc"]],standalone:!0,features:[N],decls:16,vars:8,consts:[["auto","matAutocomplete"],[1,"form-wrapper",3,"ngSubmit","formGroup"],["appearance","outline"],["type","text","matInput","",3,"formControlName","formGroup","matAutocomplete"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["autoActiveFirstOption",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","quantity"],["type","submit",1,"buto"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[3,"value"]],template:function(e,i){if(e&1){let n=h();r(0,"form",1),g("ngSubmit",function(){return l(n),d(i.save())}),r(1,"mat-form-field",2)(2,"mat-label"),m(3,"Product Name"),a(),f(4,"input",3),p(5,pt,3,0,"button",4),r(6,"mat-autocomplete",5,0),p(8,ft,2,2,"mat-option",6),x(9,"async"),a()(),r(10,"mat-form-field",2)(11,"mat-label"),m(12,"Quantity"),a(),f(13,"input",7),a(),r(14,"button",8),m(15," Save "),a()()}if(e&2){let n=y(7);u("formGroup",i.form),c(4),u("formControlName","name")("formGroup",i.form)("matAutocomplete",n),c(),u("ngIf",i.checkValue()),c(3),u("ngForOf",k(9,6,i.filteredOptions))}},dependencies:[D,w,A,F,U,E,I,G,O,B,q,L,H,K,$,z,dt,ct,R,lt,X,J,Y,j,tt,Z,nt,W],styles:['@charset "UTF-8";.form-wrapper[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;gap:1rem}.full-width[_ngcontent-%COMP%]{width:100%}.buto[_ngcontent-%COMP%]{margin:5px 8px 40px}button[_ngcontent-%COMP%]{padding:17px 40px;border-radius:10px;border:0;background-color:#3f51b5;letter-spacing:1.5px;font-size:15px;transition:all .3s ease;box-shadow:#2c3e98 0 10px;color:#fff;cursor:pointer}button[_ngcontent-%COMP%]:hover{box-shadow:#2c3e98 0 7px}button[_ngcontent-%COMP%]:active{background-color:#3f51b5;box-shadow:#2c3e98 0 0;transform:translateY(5px);transition:.2s}']})}}return o})();export{jt as AdditionProducComponent};
